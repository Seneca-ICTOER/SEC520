<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-A-Labs/lab7">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="icon" href="/SEC520/img/pwa/icon-512x512.png">
<link rel="manifest" href="/SEC520/manifest.json">
<meta name="theme-color" content="#DA291C">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#DA291C">
<link rel="apple-touch-icon" href="/SEC520/img/pwa/icon-192x192.png">
<link rel="mask-icon" href="/SEC520/img/pwa/icon-512x512.png" color="#DA291C">
<meta name="msapplication-TileImage" content="/SEC520/img/pwa/icon-512x512.png">
<meta name="msapplication-TileColor" content="#DA291C">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Lab 7 | SEC520 - Internet Security</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://Seneca-ICTOER.github.io//SEC520/A-Labs/lab7"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 7 | SEC520 - Internet Security"><meta data-rh="true" name="description" content="Lab 7 for Students to Complete and Submit"><meta data-rh="true" property="og:description" content="Lab 7 for Students to Complete and Submit"><link data-rh="true" rel="icon" href="/SEC520/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://Seneca-ICTOER.github.io//SEC520/A-Labs/lab7"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//SEC520/A-Labs/lab7" hreflang="en"><link data-rh="true" rel="alternate" href="https://Seneca-ICTOER.github.io//SEC520/A-Labs/lab7" hreflang="x-default"><link rel="stylesheet" href="/SEC520/assets/css/styles.099fe1a9.css">
<link rel="preload" href="/SEC520/assets/js/runtime~main.5ac39f4d.js" as="script">
<link rel="preload" href="/SEC520/assets/js/main.7a6e0794.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/SEC520/"><div class="navbar__logo"><img src="/SEC520/img/logo.svg" alt="Seneca College" class="themedImage_ToTc themedImage--light_HNdA"><img src="/SEC520/img/logo-dark.svg" alt="Seneca College" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">SEC520 - Internet Security</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/SEC520/">Welcome to SEC520</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/SEC520/weekly-schedule">Weekly Schedule</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/SEC520/A-Labs/lab1">Labs</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab1">Lab 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab2">Lab 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab3">Lab 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab4">Lab 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab5">Lab 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab6">Lab 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/SEC520/A-Labs/lab7">Lab 7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SEC520/A-Labs/lab8">Lab 8</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SEC520/B-Assignments/assignment1">Assignments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SEC520/C-ExtraResources/course-policies">Extra Resources</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/SEC520/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Labs</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 7</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 7</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="linux-system-hardening-part-2">Linux System Hardening (part 2)<a class="hash-link" href="#linux-system-hardening-part-2" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h3><ul><li>In the previous lab, we learned how to make our Linux server less vulnerable by setting a grub password, preventing unneccessary services from running, tunnelling with SSH, and using PAM modules for setting authentication rules when running user applications. Although this is useful, vulnerability can exist when running the few essential services.</li><li>In this lab, students will be learning about &quot;Authorization&quot; within the <strong>AAA</strong> Protocol, to limit the resources or applications that the system users are permitted to access. First, students will use <strong>ACLs</strong> (Access Control Lists) to further define authorization to groups of users within the organization.</li><li>Students will then learn how to install, configure and run <strong>SELinux</strong> which provides limitations of which users are entitled to run processes within the server. Students will then learn how to limit regular or &quot;elevated&quot; user access to regular programs or utilities (administrative) by editing the <strong>Sudoer&#x27;s file</strong>.</li><li>Finally, students will complete the &quot;lock down&quot; of the computer system by learning how to limit the running of scheduled processes (<strong>cron jobs</strong>), perform software upgrades, and to turn-off X-windows on a Linux server.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="objectives">Objectives<a class="hash-link" href="#objectives" title="Direct link to heading">​</a></h3><ol><li>Limit user access to files within defined groups using <strong>Access Control Lists</strong>.</li><li>Install, configure, and run <strong>SELinux</strong> which is used to enforce entitled users access to running processes.</li><li>Configure the <strong>sudoer&#x27;s file</strong> in order to allow other users access to linux commands that are only considered for administrators.</li><li>Control which user(s) can run <strong>cron jobs</strong> in order to run commands or programs on a scheduled basis.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-materials-bring-to-all-labs">Required Materials (Bring to All Labs)<a class="hash-link" href="#required-materials-bring-to-all-labs" title="Direct link to heading">​</a></h3><ul><li><strong>SATA Hard Disk</strong> (in removable disk tray).</li><li><strong>Lab Logbook (Lab5 Reference Sheet)</strong> (to make notes and observations).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h3><ul><li><a href="/SEC520/A-Labs/lab6">SEC520 Lab 6</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="online-tools-and-references">Online Tools and References<a class="hash-link" href="#online-tools-and-references" title="Direct link to heading">​</a></h3><ul><li><a href="http://www.yolinux.com/TUTORIALS/LinuxTutorialManagingGroups.html#ACL" target="_blank" rel="noopener noreferrer">ACLs</a></li><li><a href="http://hackinglinux.blogspot.ca/2007/05/selinux-tutorial.html" target="_blank" rel="noopener noreferrer">SELinux</a></li><li><a href="http://cs.senecac.on.ca/~fac/ops435/2008_dev/ops435_w11_l1.pdf" target="_blank" rel="noopener noreferrer">Cron Jobs</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="course-notes">Course Notes<a class="hash-link" href="#course-notes" title="Direct link to heading">​</a></h3><ul><li><a target="_blank" href="/SEC520/assets/files/sec520_w4_l1-c01f83945dbf2d850c0f53a47a098ce4.odp">odp</a> | <a target="_blank" href="/SEC520/assets/files/sec520_w4_l1-8cf39e84a9788a36ac259d50bb293cac.pdf">pdf</a> | <a target="_blank" href="/SEC520/assets/files/sec520_w4_l1-4942f9be9bdce8037b4277f2692686aa.ppt">ppt</a> (Slides: Linux System Hardening - part 2)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="performing-lab-7">Performing Lab 7<a class="hash-link" href="#performing-lab-7" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-1-acls">Task #1: ACLs<a class="hash-link" href="#task-1-acls" title="Direct link to heading">​</a></h3><p>In this section, students will learn how to use <strong>ACLs</strong> (Access Control Lists) to &quot;finely-tune&quot; group access to directories and files, and differentiate between setting permissions via ACL and setting permissions using the chmod command.</p><p><strong>INSTRUCTIONS:</strong></p><ol><li>Boot-up your Kali Linux (host) and your <strong>Hardened Linux VM</strong> on your hard disk pack.</li><li>Log into your user account that has administrative priviledges (this should have been performed during installation process in lab4).</li><li>Open a shell terminal, and create the following directory: <strong>~/share</strong></li><li>Set passthrough permissions for your home directory, and set permissions to allow same group members access and view the contents of the <strong>share</strong> directory. Use the <code>ls -ld</code> command to confirm the set permissions for these directories.</li><li>Use the <strong>groupadd</strong> command to create a new group name called <strong>project</strong></li><li>Use the <strong>usermod</strong> command to add the three users (created in lab4) to the group called <strong>project</strong>. View the contents of the <strong>/etc/group</strong> file to confirm that the users have been added to the <em>project</em> group.</li><li>Use the <strong>touch</strong> command to create an empty file in the share directory called <strong>~/share/project.txt</strong></li><li>Use the <strong>chgrp</strong> command to have the file <strong>project.txt</strong> belong to the <strong>project</strong> group. Use the <code>ls -l</code> command to confirm that the <em>project.txt</em> file now belongs to the <em>project</em> group.</li><li>Set permissions for same group members to view and modify contents of the file <strong>~/share/project.txt</strong> and confirm that the permissions have been correctly set for that file.</li><li>Switch (i.e. su) to one of the users (added to the <em>project</em> group), and confirm that they can access and modify the file: <strong>~/share/project.txt</strong></li><li>Repeat the above step for the second user (belonging to the project group).</li><li>Why can you allow the first user to both read and modify the project.txt file, but you can&#x27;t only allow the second user to only read the project.txt file without editing permissions? Answer in your lab log-book.</li></ol><p><strong>ACL Package:</strong> An <strong>ACL</strong> or <strong>Access Control List</strong> is a system that sets permissions to specific objects, as oppposed to general directories and files. This allows more flexibility when granting read, read &amp; write permissions for different users for the same file or directory.</p><ol start="13"><li>Switch (su) back to your administration account.</li><li>Issue the following command: <code>rpm -qi acl</code> to confirm that the <strong>acl</strong> application has been installed in your system. If it is not present, make certain to install that application.</li><li>In order to use <strong>ACLs</strong>, you need to edit the <strong>/etc/fstab</strong> file to mount all disk filesystems with the <strong>acl option</strong> (Refer to the following link for an example: <a href="http://www.yolinux.com/TUTORIALS/LinuxTutorialManagingGroups.html#ACL" target="_blank" rel="noopener noreferrer">Mounting With ACL Option</a>).</li><li>Issue the command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mount</span><span class="token plain"> -o remount /</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>In order to remount your file system (as opposed to rebooting).</li></ul><p><strong>Missing acl option in listed Mounts:</strong> Usually, it is a good idea to confirm that the <strong>acl</strong> option is present from the remount by viewing either the <strong>/etc/fstab</strong> or <strong>/etc/mtab</strong> files. If you are using Fedora17, it may not appear, although it is active. This may be attributed to a bug...</p><ol start="17"><li><p>View the Youtube video (or other online resources) on how to use ACLs: <a href="http://www.youtube.com/watch?v=6piQXXHTmqk" target="_blank" rel="noopener noreferrer">Video</a></p></li><li><p>Set same group members for group name <strong>project</strong> to only view the contents of the file <strong>~/share/project.txt</strong></p></li><li><p>Use the <strong>setfacl</strong> command to allow only one of the users to both view and modify the file <strong>~/share/project.txt</strong></p><ul><li>For example, if the username is <strong>user1</strong>, then issue the command:</li></ul></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">setfacl -m u:user1:rw share/project.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="20"><li>Use the <strong>getfacl</strong> to confirm the permissions for the file: <strong>~/share/project.txt</strong></li><li>Switch (su) to your account that you used the <strong>setfacl</strong> command to provide read/write permissions. Can you make editing changes to <em>project.txt</em>?</li><li>Now switch (su) to another account. Can you make editing changes to <em>project.txt</em>? Why?.</li><li>Record your results in your lab log-book.</li><li>Proceed to Task #2</li></ol><p><strong>Answer the Task #1 observations / questions in your lab log book.</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-2-selinux">Task #2: SELinux<a class="hash-link" href="#task-2-selinux" title="Direct link to heading">​</a></h3><p><strong>INSTRUCTIONS:</strong></p><p><strong>SELinux Package:</strong> Confirm that the <strong>SELinux</strong> package is installed on your Linux VM.</p><ol><li><p>Familiarize yourself with the system-config-securitylevel tool (SELinux tab) and these SELinux commands (and SELinux-modified commands):</p><ul><li>getenforce, setenforce</li><li>getsebool, setsebool</li><li>chcon</li><li>restorecon</li><li>ls -Z, ps -Z, id</li><li>gnome-system-monitor</li><li>system-config-securitylevel</li></ul></li><li><p>Ensure that your SELinux system is in <strong>enforcing</strong> mode.</p></li><li><p>Configure Apache to permit the use of <strong>$HOME/public_html</strong> directories by editing the <strong>httpd.conf</strong> file:</p><ul><li>Comment out the <strong>UserDir Disable</strong> directive.</li><li>Uncomment the <strong>UserDir public_html</strong> directive.</li><li>Uncomment the directory container for <strong>/home/<!-- -->*<!-- -->/public_html</strong> and configure it permit the execution of CGI scripts.</li><li>Uncomment the directive <strong>add_handler cgi-script .cgi</strong></li></ul></li><li><p>Restart Apache. Do not use apachectl -- use the <strong>service</strong> command.</p></li><li><p>Create <strong>~/public_html/index.html</strong></p></li><li><p>Attempt to access the content you created in step 5 using a browser. It should fail.</p></li><li><p>Review the latest avc messages in <strong>/var/log/messages</strong> and compare them to the Apache error log. Record your finding in your lab log-book.</p></li><li><p>Put SELinux in <strong>Permissive</strong> mode.</p></li><li><p>Attempt to access the content you created in step 5 using a browser. It should succeed. (If not, your <strong>httpd.conf</strong> file or permissions are incorrect - fix them).</p></li><li><p>Put SELinux back into <strong>Enforcing</strong> mode.</p></li><li><p>Using the man page for <strong>httpd_selinux</strong>, determine what is required to make <strong>~/public_html/index.html</strong> accessible while SELinux is in Enforcing mode. Test it and make sure it works.</p></li><li><p>Create the following Bash shell script (called <strong>test.bash</strong>):</p></li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Content-type: text/plain&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cal</span><span class="token plain"> -y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="13"><li>Test your script through a web browser.</li><li>Create the following testing CGI script (called <strong>test.cgi</strong>):</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Content-type: text/plain&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Attempting to show the contents of ~/.bash_profile:&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> ~/.bash_profile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$?</span><span class="token plain"> -eq </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Success.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Failure.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="15"><li>Run this script via the web browser in both <strong>Permissive</strong> and <strong>Enforcing</strong> modes. Observe the difference in output. What is the reason for the difference?</li><li>Record your findings in your lab log-book.</li><li>Proceed to Task #3</li></ol><p><strong>Answer Task #2 observations / questions in your lab log book.</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-3-sudo">Task #3: Sudo<a class="hash-link" href="#task-3-sudo" title="Direct link to heading">​</a></h3><p><em>&quot;Sudo (switchuser/superuser do) allows a system administrator to give certain users (or groups of users) the ability to run some (or all) commands as root while logging all commands and arguments. Sudo operates on a per-command basis, it is not a replacement for the shell.&quot;</em></p><p><strong>INSTRUCTIONS:</strong></p><ol><li>READ the man page on <strong>sudo</strong> and <strong>visudo</strong>. Most modern versions of Linux have sudo default installed.</li><li>Open sudoers using <strong>visudo</strong>.</li><li>We will be <strong>setting up logging information</strong> as well as allowing the <strong>third user to issue certain administrative commands</strong>. With the setup below, this lab is making reference to username: <strong>user3</strong> (replace this with the actual username of the third user). Make the following changes to the <strong>sudoer&#x27;s file</strong>, adding information that appears in <strong>bold</strong>:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># sudoers file. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># This file MUST be edited with the &#x27;visudo&#x27; command as root. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># See the sudoers man page for the details on how to write a sudoers file. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Host alias specification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Host_Alias </span><span class="token assign-left variable" style="color:#36acaa">MYHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">localhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># User alias specification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        User_Alias </span><span class="token assign-left variable" style="color:#36acaa">USER3</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">user3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Cmnd alias specification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Cmnd_Alias </span><span class="token assign-left variable" style="color:#36acaa">NETWORK</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/sbin/ifconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Note: you NEED the ABSOLUTE path to the </span><span class="token builtin class-name">command</span><span class="token plain"> you put </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> there.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># User privilege specification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        root    </span><span class="token assign-left variable" style="color:#36acaa">ALL</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ALL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ALL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        user3   </span><span class="token assign-left variable" style="color:#36acaa">ALL</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">NETWORK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Defaults Specification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Defaults   </span><span class="token assign-left variable" style="color:#36acaa">syslog</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">local1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Watch Syntax in Sudoers File:</strong> The sudoers file should always be edited by the visudo command which locks the file and does grammatical checking. It is imperative that sudoers be free of syntax errors since sudo will not run with a syntactically incorrect sudoers file</p><ol start="4"><li>Save and exit the visudo editing session. Check and return to editing session if any errors are created.</li><li>Edit the file <strong>/etc/rsyslog.conf</strong> and add the following line to the bottom of this file (for logging purposes):</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    local1.*    /var/adm/sudo.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="6"><li>Save your editing changes.</li><li>Switch (su) as the third user (eg. in our demonstration: <strong>user3</strong>).</li><li>Experiment with the sudo capabilities assigned to the third user by issuing the command: <code>sudo /sbin/ifconfig eth0</code> (You&#x27;ll have to supply the user password). For the purpose of this lab, the command does not have to work - don&#x27;t worry about error messages.</li><li>Return to the administrator account.</li><li>Check the <strong>/var/adm/sudo.log</strong> file. What does it show ?</li></ol><p><strong>No Entries in /var/adm/sudo.log File</strong> If you do not see any entries in the <strong>/var/adm/sudo.log</strong> file, then shutdown, and then restart your Hardened Linux VM, and repeat <strong>steps 7 to 10</strong>.</p><ol start="11"><li>Switch (su) to a different user (other than your third user), and try to issue the command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> /sbin/ifconfig eth0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>What happenned?</li></ul><ol start="12"><li>Switch (su) to the administrator&#x27;s account, and view the contents of <strong>/var/adm/sudo.log</strong>. What do you notice?</li><li>Edit the sudoers file and add the following line (where hostname is your VM machine):</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">USER3 localhost.localdomain</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="14"><li>While in edit mode, add <strong>USER1</strong> as an alias for user1, and add the <strong>kill</strong> command to the <strong>Cmnd_Aliases</strong> line for <strong>user1</strong>. Each line should appear similar to this:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">      User_Alias </span><span class="token assign-left variable" style="color:#36acaa">USER1</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">user1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    USER1 localhost.localdomain</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PASSWD: /bin/kill</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="15"><li>Save changes to the sudoer&#x27;s file and exit.</li><li>Switch (su) as the third user and attempt to kill a process. Where you prompted to enter a password? Then switch (su) as the first user (eg. <strong>user1</strong>) and attempt to kill another process. Where you prompted to enter a password?</li><li>Switch (su) to the third user, and execute the following command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> -l</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>What did this command do?</li></ul><p><strong>Vulnerability with Sudo (vi)</strong></p><p>There is no easy way to prevent a user from gaining a root shell if that user has access to commands allowing shell escapes. If users have sudo <strong>ALL</strong>, there is nothing to prevent them from creating their own program that gives them a root shell regardless of any &#x27;!&#x27; elements in the user specification.</p><p>Running shell scripts via sudo can expose the same kernel bugs that make setuid shell scripts unsafe on some operating systems (if your OS supports the <strong>/dev/fd</strong> directory, setuid shell scripts are generally safe). (From sudo man page)</p><ol start="18"><li>Grant <strong>vi</strong> privileges to the third user. Switch (su) as the third user and issue the command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Press : to go to the <strong>last line mode</strong> in your vi text editor, and issue the command:</li></ul><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">!</span><span class="token plain">id</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="19"><li>What was the id of the third user and what what sort of implications does this create in terms of system security?</li><li>Record your findings in your lab log-book.</li><li>Proceed to Task #4.</li></ol><p><strong>Answer Task #3 observations / questions in your lab log book.</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="task-4-cron-jobs--turning-off-xwindows">Task #4: Cron Jobs &amp; Turning off XWindows<a class="hash-link" href="#task-4-cron-jobs--turning-off-xwindows" title="Direct link to heading">​</a></h3><p>This last section involves &quot;tweaks&quot; to harden your Linux system from less obvious vulnerabilities. First, you will learn as the adiminstrator to limit <strong>cron jobs</strong> (i.e. scheduled tasks) that can be run by users. Finally, you will change from run level 5 (Xwindows) to level 3 (text-based) to make your system less vulnerable to attacks.</p><p><strong>INSTRUCTIONS:</strong></p><ol><li>Switch to the super-user, and issue the following command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">crontab</span><span class="token plain"> -u user1 -e</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>Add the following contents into the first user&#x27;s <strong>crontab</strong> file:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  * * * * * </span><span class="token string" style="color:#e3116c">&#x27;uptime &gt;&gt; ~/uptime.txt&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>Save and exit your crontab editing session.</li><li>Edit the <strong>/etc/crontab.allow</strong> file to include the first user. If the file does not exist, simply create it, or check with the Linux distribution for instructions to use the crontab.allow file.</li><li>Login to the first user and see if your cron job is working.</li><li>Login to the second user (created in lab4) to see if that account can create a cron job. Where you successful? Why?</li><li>Try to list at least 3 types of Bash Shell scripts that a Linux system administrator can limit to specific users. Record your findings in your lab log-book.</li><li>Perform another software update (either graphically or using the <strong>yum</strong> or <strong>apt-get</strong> commands). Verify that the software upgrades are up-to-date.</li><li>Switch your Linux server from graphical mode (eg run level 5) to default mode (eg run level 3). <strong>Note</strong>: The procedure has changed in newer Linux system (using <strong>sysd</strong>). Refer to the following link to learn how to set your Fedora17 system to text-based mode: <a href="http://zenit.senecac.on.ca/wiki/index.php/Init_vs_systemd" target="_blank" rel="noopener noreferrer">Init vs Systemd</a></li><li>Perform a scan from your Kali Linux (host) machine to hopefully see a more hardened system with less running services.</li><li>Proceed to &quot;Completing The Lab&quot;.</li></ol><p><strong>Answer Task #4 observations / questions in your lab log book.</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="completing-the-lab">Completing the Lab<a class="hash-link" href="#completing-the-lab" title="Direct link to heading">​</a></h2><p><strong>Arrange evidence for each of these items on your screen, then ask your instructor to review them and sign off on the lab&#x27;s completion:</strong></p><ol><li>Compare ACLs by demonstrating running services via <strong>user1</strong> and <strong>user2</strong>.</li><li>Verify SELinux is running in <strong>Enforcing</strong> mode.</li><li>Display contents of <strong>sudoer&#x27;s file (for user1)</strong>.</li><li>Verification of running <strong>crob job</strong>.</li><li>Linux system in <strong>text-based mode</strong> (i.e. run level 3 for your <strong>Hardened Linux</strong> system).</li><li>Completed Lab 7 notes.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparing-for-quizzes">Preparing for Quizzes<a class="hash-link" href="#preparing-for-quizzes" title="Direct link to heading">​</a></h2><ol><li>What does the term <strong>ACL</strong> stand for?</li><li>Compare and contrast the features of ACLs for Windows (using NTFS) and Linux.</li><li>What is the purpose of <strong>ACLs</strong>?</li><li>What is the purpose of <strong>SELinux</strong>.</li><li>List the various modes of <strong>SELinux</strong>.</li><li>Briefly list the steps to allow the regular user called <strong>msaul</strong> to run administrative commands.</li><li>Briefly explain how to setup the sudoer&#x27;s file to have the user <strong>ctyler</strong> only run the administrative command:</li></ol><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">visudo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="8"><li>Briefly list the steps to allow <strong>user1</strong> to run a <strong>cron job</strong> called <strong>cleanup.bash</strong></li><li>Write a Linux command to perform a software update.</li><li>Write a Linux command to set the Linux server to text-based mode.</li><li>Why is it recommended to run a Linux server in text-based mode?</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seneca-ICTOER/SEC520/tree/main/docs/A-Labs/lab7.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/SEC520/A-Labs/lab6"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 6</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/SEC520/A-Labs/lab8"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 8</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#linux-system-hardening-part-2" class="table-of-contents__link toc-highlight">Linux System Hardening (part 2)</a><ul><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#objectives" class="table-of-contents__link toc-highlight">Objectives</a></li><li><a href="#required-materials-bring-to-all-labs" class="table-of-contents__link toc-highlight">Required Materials (Bring to All Labs)</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#online-tools-and-references" class="table-of-contents__link toc-highlight">Online Tools and References</a></li><li><a href="#course-notes" class="table-of-contents__link toc-highlight">Course Notes</a></li></ul></li><li><a href="#performing-lab-7" class="table-of-contents__link toc-highlight">Performing Lab 7</a><ul><li><a href="#task-1-acls" class="table-of-contents__link toc-highlight">Task #1: ACLs</a></li><li><a href="#task-2-selinux" class="table-of-contents__link toc-highlight">Task #2: SELinux</a></li><li><a href="#task-3-sudo" class="table-of-contents__link toc-highlight">Task #3: Sudo</a></li><li><a href="#task-4-cron-jobs--turning-off-xwindows" class="table-of-contents__link toc-highlight">Task #4: Cron Jobs &amp; Turning off XWindows</a></li></ul></li><li><a href="#completing-the-lab" class="table-of-contents__link toc-highlight">Completing the Lab</a></li><li><a href="#preparing-for-quizzes" class="table-of-contents__link toc-highlight">Preparing for Quizzes</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">SEC520 - Internet Security</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/SEC520/">Contents</a></li><li class="footer__item"><a href="#" id="pwa-button" class="footer__link-item" hidden>Install as an App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Seneca College.</div></div></div></footer></div>
<script src="/SEC520/assets/js/runtime~main.5ac39f4d.js"></script>
<script src="/SEC520/assets/js/main.7a6e0794.js"></script>
</body>
</html>